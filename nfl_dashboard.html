<!DOCTYPE html><html lang="en"><head>    <meta charset="UTF-8">    <meta name="viewport" content="width=device-width, initial-scale=1.0">    <title>NFL Score Predictions Dashboard</title>    <!-- Tailwind CSS for quick styling -->    <script src="https://cdn.tailwindcss.com"></script>    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;900&display=swap" rel="stylesheet">    <style>        body {            font-family: 'Inter', sans-serif;            background-color: #111827; /* bg-gray-900 */        }        .card {            background-color: #1F2937; /* bg-gray-800 */            border: 1px solid #374151; /* border-gray-700 */            transition: transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out;        }        .card:hover {            transform: translateY(-5px);            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);        }        .loader {            border-top-color: #3498db;            animation: spin 1s ease-in-out infinite;        }        @keyframes spin {            to { transform: rotate(360deg); }        }        .team-logo {            width: 64px;            height: 64px;            object-fit: contain;        }        @media (max-width: 640px) {            .team-logo {                width: 48px;                height: 48px;            }        }        #progress-bar {            transition: width 0.2s ease-out;        }    </style></head><body class="text-gray-200">    <div class="container mx-auto p-4 md:p-8">        <!-- Header -->        <header class="text-center mb-8">            <h1 class="text-4xl md:text-5xl font-extrabold text-white tracking-tight">NFL Score Predictions</h1>            <p class="mt-2 text-lg text-gray-400">Interactive dashboard to visualize game outcomes</p>        </header>        <!-- Controls -->        <div class="bg-gray-800 border border-gray-700 rounded-lg p-4 mb-8 flex flex-col md:flex-row items-center justify-center space-y-4 md:space-y-0 md:space-x-6 sticky top-4 z-10 shadow-lg">            <div>                <label for="season-select" class="block text-sm font-medium text-gray-400 mb-1">Season</label>                <select id="season-select" class="bg-gray-700 border border-gray-600 text-white text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5">                    <!-- Static season options.  Update as new seasons become available. -->                    <option value="2025">2025</option>                    <option value="2024">2024</option>                    <option value="2023">2023</option>                </select>            </div>            <div>                <label for="week-select" class="block text-sm font-medium text-gray-400 mb-1">Week</label>                <select id="week-select" class="bg-gray-700 border border-gray-600 text-white text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5">                    <!-- Weeks will be populated by JS -->                </select>            </div>            <button id="predict-btn" class="w-full md:w-auto bg-blue-600 hover:bg-blue-700 text-white font-bold py-2.5 px-6 rounded-lg transition duration-300 ease-in-out transform hover:scale-105 mt-4 md:mt-0 md:self-end">                Generate Predictions            </button>        </div>        <!-- Predictions Area -->        <main id="predictions-container">            <div id="loader-container" class="hidden text-center py-16">                 <p class="mb-4 text-lg text-gray-400">Analyzing matchups and generating predictions...</p>                <div class="w-full max-w-md mx-auto bg-gray-700 rounded-full h-2.5">                    <div id="progress-bar" class="bg-blue-600 h-2.5 rounded-full" style="width: 0%"></div>                </div>                <p id="progress-text" class="mt-2 text-sm text-gray-400">0%</p>            </div>            <div id="predictions-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">                <!-- Prediction cards will be inserted here -->            </div>            <div id="no-games-message" class="hidden text-center py-16 card">                <p class="text-2xl font-bold text-gray-300">No Games Found</p>                <p class="mt-2 text-gray-400">There are no scheduled games for the selected week.</p>            </div>        </main>        <!-- Model Performance Section -->        <section class="mt-16">            <h2 class="text-3xl font-bold text-center mb-6 text-white">Model Performance Metrics</h2>            <div class="overflow-x-auto card rounded-lg shadow-md">                <table class="min-w-full text-sm text-left text-gray-300">                    <thead class="text-xs text-gray-200 uppercase bg-gray-700">                        <tr>                            <th scope="col" class="px-6 py-3">Model</th>                            <th scope="col" class="px-6 py-3 text-center">Total MAE</th>                            <th scope="col" class="px-6 py-3 text-center">Total RMSE</th>                            <th scope="col" class="px-6 py-3 text-center">Home R²</th>                            <th scope="col" class="px-6 py-3 text-center">Away R²</th>                        </tr>                    </thead>                    <tbody id="metrics-table-body">                        <!-- Model metrics rows will be inserted here -->                    </tbody>                </table>            </div>        </section>    </div>    <script>        document.addEventListener('DOMContentLoaded', () => {            // Mapping of team abbreviations to full names and logos.  If a team            // abbreviation is missing, a placeholder logo and name are used.            const teamData = {                'ARI': { name: 'Arizona Cardinals', logo: 'https://a.espncdn.com/i/teamlogos/nfl/500/ari.png' },                'ATL': { name: 'Atlanta Falcons', logo: 'https://a.espncdn.com/i/teamlogos/nfl/500/atl.png' },                'BAL': { name: 'Baltimore Ravens', logo: 'https://a.espncdn.com/i/teamlogos/nfl/500/bal.png' },                'BUF': { name: 'Buffalo Bills', logo: 'https://a.espncdn.com/i/teamlogos/nfl/500/buf.png' },                'CAR': { name: 'Carolina Panthers', logo: 'https://a.espncdn.com/i/teamlogos/nfl/500/car.png' },                'CHI': { name: 'Chicago Bears', logo: 'https://a.espncdn.com/i/teamlogos/nfl/500/chi.png' },                'CIN': { name: 'Cincinnati Bengals', logo: 'https://a.espncdn.com/i/teamlogos/nfl/500/cin.png' },                'CLE': { name: 'Cleveland Browns', logo: 'https://a.espncdn.com/i/teamlogos/nfl/500/cle.png' },                'DAL': { name: 'Dallas Cowboys', logo: 'https://a.espncdn.com/i/teamlogos/nfl/500/dal.png' },                'DEN': { name: 'Denver Broncos', logo: 'https://a.espncdn.com/i/teamlogos/nfl/500/den.png' },                'DET': { name: 'Detroit Lions', logo: 'https://a.espncdn.com/i/teamlogos/nfl/500/det.png' },                'GB': { name: 'Green Bay Packers', logo: 'https://a.espncdn.com/i/teamlogos/nfl/500/gb.png' },                'HOU': { name: 'Houston Texans', logo: 'https://a.espncdn.com/i/teamlogos/nfl/500/hou.png' },                'IND': { name: 'Indianapolis Colts', logo: 'https://a.espncdn.com/i/teamlogos/nfl/500/ind.png' },                'JAX': { name: 'Jacksonville Jaguars', logo: 'https://a.espncdn.com/i/teamlogos/nfl/500/jax.png' },                'KC': { name: 'Kansas City Chiefs', logo: 'https://a.espncdn.com/i/teamlogos/nfl/500/kc.png' },                'LV': { name: 'Las Vegas Raiders', logo: 'https://a.espncdn.com/i/teamlogos/nfl/500/lv.png' },                'LAC': { name: 'Los Angeles Chargers', logo: 'https://a.espncdn.com/i/teamlogos/nfl/500/lac.png' },                'LAR': { name: 'Los Angeles Rams', logo: 'https://a.espncdn.com/i/teamlogos/nfl/500/lar.png' },                'MIA': { name: 'Miami Dolphins', logo: 'https://a.espncdn.com/i/teamlogos/nfl/500/mia.png' },                'MIN': { name: 'Minnesota Vikings', logo: 'https://a.espncdn.com/i/teamlogos/nfl/500/min.png' },                'NE': { name: 'New England Patriots', logo: 'https://a.espncdn.com/i/teamlogos/nfl/500/ne.png' },                'NO': { name: 'New Orleans Saints', logo: 'https://a.espncdn.com/i/teamlogos/nfl/500/no.png' },                'NYG': { name: 'New York Giants', logo: 'https://a.espncdn.com/i/teamlogos/nfl/500/nyg.png' },                'NYJ': { name: 'New York Jets', logo: 'https://a.espncdn.com/i/teamlogos/nfl/500/nyj.png' },                'PHI': { name: 'Philadelphia Eagles', logo: 'https://a.espncdn.com/i/teamlogos/nfl/500/phi.png' },                'PIT': { name: 'Pittsburgh Steelers', logo: 'https://a.espncdn.com/i/teamlogos/nfl/500/pit.png' },                'SF': { name: 'San Francisco 49ers', logo: 'https://a.espncdn.com/i/teamlogos/nfl/500/sf.png' },                'SEA': { name: 'Seattle Seahawks', logo: 'https://a.espncdn.com/i/teamlogos/nfl/500/sea.png' },                'TB': { name: 'Tampa Bay Buccaneers', logo: 'https://a.espncdn.com/i/teamlogos/nfl/500/tb.png' },                'TEN': { name: 'Tennessee Titans', logo: 'https://a.espncdn.com/i/teamlogos/nfl/500/ten.png' },                'WAS': { name: 'Washington Commanders', logo: 'https://a.espncdn.com/i/teamlogos/nfl/500/wsh.png' },            };            // UI Elements            const seasonSelect = document.getElementById('season-select');            const weekSelect = document.getElementById('week-select');            const predictBtn = document.getElementById('predict-btn');            const predictionsGrid = document.getElementById('predictions-grid');            const loaderContainer = document.getElementById('loader-container');            const noGamesMessage = document.getElementById('no-games-message');            const metricsTableBody = document.getElementById('metrics-table-body');            /**             * Populate the week dropdown with numbers 1 through 18.             */            function populateWeeks() {                weekSelect.innerHTML = '';                for (let i = 1; i <= 18; i++) {                    const option = document.createElement('option');                    option.value = i;                    option.textContent = `Week ${i}`;                    weekSelect.appendChild(option);                }            }            /**             * Rounds a number to the nearest 0.5.             * @param {number} value - The number to round.             * @returns {number} The rounded number.             */            function roundToHalf(value) {                if (typeof value !== 'number') return value;                return Math.round(value * 2) / 2;            }            /**             * Create an HTML card for a single game prediction.             * @param {object} game - The game prediction data.             * @returns {string} - The HTML string for the card.             */            function createGameCard(game) {                const home = teamData[game.home_team] || { name: game.home_team, logo: 'https://placehold.co/64x64/1F2937/FFFFFF?text=NFL' };                const away = teamData[game.away_team] || { name: game.away_team, logo: 'https://placehold.co/64x64/1F2937/FFFFFF?text=NFL' };                const awayPred = roundToHalf(game.away_pred);                const homePred = roundToHalf(game.home_pred);                const predSpread = roundToHalf(game.pred_spread);                const predTotal = roundToHalf(game.pred_total);                return `                    <div class="card rounded-lg p-5 flex flex-col">                        <div class="flex items-center justify-between">                            <!-- Away Team -->                            <div class="flex flex-col items-center text-center w-2/5">                                <img src="${away.logo}" alt="${away.name}" class="team-logo mb-2" onerror="this.onerror=null;this.src='https://placehold.co/64x64/1F2937/FFFFFF?text=NFL';">                                <span class="font-bold text-base md:text-lg">${away.name}</span>                                <span class="text-3xl md:text-4xl font-black text-gray-400">${awayPred.toFixed(1)}</span>                            </div>                            <!-- VS -->                            <div class="text-2xl font-bold text-gray-500">VS</div>                            <!-- Home Team -->                            <div class="flex flex-col items-center text-center w-2/5">                                <img src="${home.logo}" alt="${home.name}" class="team-logo mb-2" onerror="this.onerror=null;this.src='https://placehold.co/64x64/1F2937/FFFFFF?text=NFL';">                                <span class="font-bold text-base md:text-lg">${home.name}</span>                                <span class="text-3xl md:text-4xl font-black text-white">${homePred.toFixed(1)}</span>                            </div>                        </div>                        <!-- Divider -->                        <div class="border-t border-gray-700 my-4"></div>                        <!-- Prediction Details -->                        <div class="space-y-2 text-sm">                            <div class="flex justify-between">                                <span class="text-gray-400">Predicted Spread:</span>                                <span class="font-semibold">${predSpread >= 0 ? '+' : ''}${predSpread.toFixed(1)} ${game.home_team}</span>                            </div>                            <div class="flex justify-between">                                <span class="text-gray-400">Vegas Spread:</span>                                <span class="font-semibold">${game.spread_line !== null && game.spread_line !== undefined ? (game.spread_line > 0 ? '+' : '') + game.spread_line : 'N/A'} ${game.home_team}</span>                            </div>                            <div class="flex justify-between">                                <span class="text-gray-400">Predicted Total:</span>                                <span class="font-semibold">${predTotal.toFixed(1)}</span>                            </div>                            <div class="flex justify-between">                                <span class="text-gray-400">Vegas Total:</span>                                <span class="font-semibold">${game.total_line !== null && game.total_line !== undefined ? game.total_line : 'N/A'}</span>                            </div>                        </div>                    </div>                `;            }            /**             * Fetch model performance metrics from the API.             * @returns {Promise<Array>} A promise resolving to an array of metric objects.             */            async function fetchModelMetrics() {                try {                    const response = await fetch('/api/metrics');                    if (!response.ok) {                        throw new Error(`HTTP error ${response.status}`);                    }                        return await response.json();                } catch (err) {                    console.error('Error fetching model metrics:', err);                    return [];                }            }            /**             * Populate the metrics table with data from the API.             */            async function populateMetricsTable() {                const metrics = await fetchModelMetrics();                // Sort by RMSE_total ascending; if field missing, treat as Infinity                const sorted = metrics.slice().sort((a, b) => (a.RMSE_total ?? Infinity) - (b.RMSE_total ?? Infinity));                metricsTableBody.innerHTML = sorted.map((metric, index) => `                    <tr class="${index === 0 ? 'bg-gray-700/50' : ''} border-b border-gray-700 hover:bg-gray-600/50">                        <td class="px-6 py-4 font-medium text-white whitespace-nowrap">                            ${metric.model}${index === 0 ? ' <span class="text-xs text-blue-400 ml-2">(Best)</span>' : ''}                        </td>                        <td class="px-6 py-4 text-center">${metric.MAE_total !== undefined ? metric.MAE_total.toFixed(2) : 'N/A'}</td>                        <td class="px-6 py-4 text-center">${metric.RMSE_total !== undefined ? metric.RMSE_total.toFixed(2) : 'N/A'}</td>                        <td class="px-6 py-4 text-center">${metric.R2_home !== undefined ? metric.R2_home.toFixed(2) : 'N/A'}</td>                        <td class="px-6 py-4 text-center">${metric.R2_away !== undefined ? metric.R2_away.toFixed(2) : 'N/A'}</td>                    </tr>                `).join('');            }            /**             * Fetch predictions for the selected season and week from the API.             * @param {number} season - The selected season.             * @param {number} week - The selected week.             * @returns {Promise<Array>} A promise resolving to an array of game predictions.             */            async function fetchPredictions(season, week) {                const url = `/api/predict?season=${season}&week=${week}`;                try {                    const response = await fetch(url);                    if (!response.ok) {                        throw new Error(`HTTP error ${response.status}`);                    }                    return await response.json();                } catch (err) {                    console.error('Error fetching predictions:', err);                    return [];                }            }            /**             * Handle generation of predictions when user clicks the button.             */            async function handlePredictionGeneration() {                const selectedSeason = parseInt(seasonSelect.value);                const selectedWeek = parseInt(weekSelect.value);                // Get progress elements                const progressBar = document.getElementById('progress-bar');                const progressText = document.getElementById('progress-text');                                // Show loader and clear previous content                loaderContainer.classList.remove('hidden');                predictionsGrid.innerHTML = '';                noGamesMessage.classList.add('hidden');                // Reset progress bar                progressBar.style.width = '0%';                progressText.textContent = '0%';                let progress = 0;                // Use a variable to hold the interval ID so we can clear it.                let progressInterval = setInterval(() => {                    // Increment progress with a bit of randomness to look more realistic                    progress += Math.random() * 5;                    if (progress > 95) {                        progress = 95; // Cap at 95% until fetch is complete                    }                    progressBar.style.width = `${progress}%`;                    progressText.textContent = `${Math.round(progress)}%`;                }, 150); // Update every 150ms                // Fetch predictions from the server                const predictions = await fetchPredictions(selectedSeason, selectedWeek);                // Stop the simulated progress                clearInterval(progressInterval);                                // Complete the progress bar                progressBar.style.width = '100%';                progressText.textContent = '100%';                // Short delay to show 100% before hiding                setTimeout(() => {                    loaderContainer.classList.add('hidden');                    if (Array.isArray(predictions) && predictions.length > 0) {                        predictionsGrid.innerHTML = predictions.map(createGameCard).join('');                    } else {                        noGamesMessage.classList.remove('hidden');                    }                }, 500);            }            // Initialise the dropdowns and metrics on page load            populateWeeks();            populateMetricsTable();            // Set initial selection for convenience            seasonSelect.value = '2025';            weekSelect.value = '1';            // Generate predictions for the initial selection            handlePredictionGeneration();            // Attach event listener to the button            predictBtn.addEventListener('click', handlePredictionGeneration);        });    </script></body></html>